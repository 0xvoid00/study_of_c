# Study of **Stride**

## 변수의 개념 확장

기존 개념: 값을 담는 상자  
확장 개념: 변수는 메모리 주소에 붙인 닉네임이고, Type은 그 메모리를 해석하는 방법

> **그래서 그게 뭐?**  
> 상자는 사실 메모리 공간이였고, 변수 이름은 그 메모리 공간의 주소를 기억하기 쉽게 별명으로 치환한 것.  
> 그리고 Type은 개발자가 무슨 형태의 변수인지 보기 위함도 있지만  
> 사실 메모리 시작 지점부터 얼마나 메모리 공간을 읽어나갈지에 대한 정보를 제공하기 위함.

## Memory Layout
>
> 프로그래머는 코드를 작성할 때 이 변수가 컴퓨터의 어디에 박히는지 머릿속에 그려지고 있어야 한다.

* **Code**(Text): 작성한 코드가 기계어로 변환되어 저장 (Read-only)
* **Data**(`BSS`/`GVAR`): 전역 변수, 정적(static) 변수, 프로그램의 시작부터 끝까지 생존
* **Heap**: 프로그래머가 `malloc`으로 직접 관리하는 영역
* **Stack**: 지역 변수, 매개변수, 함수가 호출될 때 쌓이고 리턴되면 증발 -> overflow를 이용하여 복귀 주소 접근 뒤 주소 조작을 통하여 해킹 가능(주요 표적)

> **Stack 복귀주소 취약점을 막기 위한 OS의 방패들**  
> **Stack Canary**: 복귀 주소 앞의 '비밀 값'을 확인하여 오염 감지.  
> **ASLR**: 메모리 주소를 매번 랜덤하게 배치하여 예측 불가능하게 함.  
> **NX/DEP**: 스택/힙 영역에서 코드가 실행되는 것을 원천 차단.  
> **Conclusion:** > 현대 시스템은 다중 방어 체계를 갖추고 있어 단순 BOF는 어렵지만, 공격자들은 **Leak**(유출)과 **ROP**(코드 조립) 기법을 통해 이를 우회함.  

```text
┌──────────────────┐ Low Address (0x0000)
│      Code        │ (Text Segment)
├──────────────────┤
│      Data        │ (GVAR, BSS)
├──────────────────┤
│      Heap        │ (Grow up ↑)
├──────────────────┤
│        :         │
├──────────────────┤
│      Stack       │ (Grow down ↓)
└──────────────────┘ High Address (0xFFFF)
```

### Data (GVAR) vs BSS (전역 변수 영역)

| 영역 | 구분 | 초깃값 여부 | 특징 |
| :---: | :---: | :---: | :--- |
| **Data (GVAR)** | `Initialized` | **O** | 소스코드에 값이 지정된 변수들이 저장됨 |
| **BSS** | `Uninitialized` | **X** | 초깃값이 없는 변수들. 프로그램 실행 시 0으로 초기화됨 |

> **Why BSS?**  
> 초기값이 없는 변수들을 전부 0으로 채워서 실행 파일(Binary)에 저장하면 파일 용량이 너무 커짐  
> 그래서 BSS 영역을 따로 두어 나중에 0으로 채울테니 자리만 맡아달라고 처하여 파일 크기를 최적화함
